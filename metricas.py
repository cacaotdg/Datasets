# -*- coding: utf-8 -*-
"""metricas.ipynb

Automatically generated by Colab.
"""

import subprocess
subprocess.run(["pip", "install", "-q", "ultralytics"])

import os
from ultralytics import YOLO

# Cargar el modelo entrenado
model_path = "/content/runs/detect/train/weights/best.pt"
model = YOLO(model_path)
print("Modelo entrenado cargado correctamente")

# Evaluar el modelo
metrics = model.val(data=data_path)

# Calcular métricas principales
iou_50 = metrics.box.map50  # mAP@0.5
precision = metrics.box.mp  # Precisión
recall = metrics.box.mr     # Recall
f1_score = 2 * (precision * recall) / (precision + recall)

# Mostrar métricas
print("\nResultados del modelo:")
print(f"IoU@0.5 (mAP@0.5): {iou_50:.4f}")
print(f"Precisión: {precision:.4f}")
print(f"Recall: {recall:.4f}")
print(f"F1-Score: {f1_score:.4f}")
