# -*- coding: utf-8 -*-
"""entrenamiento.ipynb

Automatically generated by Colab.
"""

import subprocess
subprocess.run(["pip", "install", "-q", "ultralytics", "albumentations"])

import os
from ultralytics import YOLO

# Clonar repositorio con los datasets
subprocess.run(["git", "clone", "https://github.com/cacaotdg/Datasets.git"])
dataset_path = "/content/Datasets/escenas"

# opciones posibles: "PCA_closed", "PCA_open", "SPEC_closed", "SPEC_open"
data_path = os.path.join(dataset_path, "PCA_open", "data.yaml")

print(f"Dataset cargado desde: {data_path}")

# Cargar modelo YOLO preentrenado
model = YOLO("yolov8m.pt")
print("Modelo YOLO cargado correctamente")

# Entrenar el modelo
results = model.train(
    data=data_path,
    epochs=300,
    imgsz=800,
    batch=8,
    conf=0.3,
    iou=0.45,
    cos_lr=True,
    lrf=0.001,
    hsv_h=0.01,
    hsv_s=0.2,
    hsv_v=0.2,
    fliplr=0.3,
    translate=0.1,
    scale=0.3,
    shear=0.0,
    perspective=0.0,
    mosaic=0.3,
    mixup=0
)

# Guardar el modelo entrenado
print("Entrenamiento finalizado.")
